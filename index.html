<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Digital Human Only</title>
    <style>
        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            overflow: hidden;
            background-color: transparent !important;
        }
        /* 隐藏所有非 Canvas 元素，确保界面纯净 */
        body *:not(canvas) {
            background-color: transparent !important;
            border: none !important;
            box-shadow: none !important;
        }
        canvas {
            display: block !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
    </style>
</head>
<body>
    <script type="module" src="https://avatar.gbqr.net/yiyu.js"></script>

    <script>
        let isReady = false;

        function initAvatar() {
            if (window.yiyu && window.yiyu.app) {
                console.log('[Avatar] SDK found, initializing...');
                
                yiyu.app.init({
                    name: 'gGcIeTrZFm4E0D6UHZH1v2JhmCbncSDLxVMA1UktGzr/95F9TtaHL4zgSM7RqXL8Qf664k/ApAzRh1plKDv7xG2dycU7orqy/lfO9U747ZN8RKGdqWw886u2zD6eTvPnwRTBUId2/ly2+wEoPG6UHtsYJtn04MzB/Hw3EfO6MAQ=', 
                    readLocalResource: false,
                    draggable: false,
                    showToast: false 
                });

                // 正确的监听方法
                yiyu.app.onAppReady(function() {
                    console.log('[Avatar] App is ready!');
                    yiyu.app.disableHyperTranslation();
                    yiyu.app.disableTextSelection();
                    yiyu.app.setPosition(0, 0); 
                    yiyu.app.setSize('100%', '100%');
                    yiyu.app.setAvatarSize(1);
                    
                    isReady = true;
                    // 通知 iOS 原生
                    if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.loadComplete) {
                        window.webkit.messageHandlers.loadComplete.postMessage('ready');
                    }
                });
            } else {
                // 如果 SDK 还没加载完，100ms 后重试
                setTimeout(initAvatar, 100);
            }
        }

        window.addEventListener('load', initAvatar);

        // --- iOS 调用的接口 ---
        window.sendSignText = function(text) {
            if (isReady && window.yiyu && window.yiyu.app) {
                yiyu.app.startTranslate(text);
            }
        };

        window.stopSign = function() {
            if (isReady && window.yiyu && window.yiyu.app) {
                yiyu.app.cancelTranslation();
            }
        };
    </script>
</body>
</html>